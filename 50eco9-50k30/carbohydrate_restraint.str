* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Nov, 26. 2018. JOBID=1543203639
* DIHEDRAL RESTRAINT POTENTIALS FOR CARBOHYDRATES
*

coor stat sele all end
set natom = ?nsel

define DCARB sele ( resn %GLC    .or. resn %GLCN   .or. resn %GLCNA  .or. resn %GLCA   .or. resn %MAN    .or. -
                    resn %MANN   .or. resn %MANNA  .or. resn %MANA   .or. resn %GAL    .or. resn %GALN   .or. -
                    resn %GALNA  .or. resn %GALA   .or. resn %GUL    .or. resn %GULN   .or. resn %GULNA  .or. -
                    resn %GULA   .or. resn %ALT    .or. resn %ALTN   .or. resn %ALTNA  .or. resn %ALTA   .or. -
                    resn %ALL    .or. resn %ALLN   .or. resn %ALLNA  .or. resn %ALLA   .or. resn %TAL    .or. -
                    resn %TALN   .or. resn %TALNA  .or. resn %TALA   .or. resn %IDO    .or. resn %IDON   .or. -
                    resn %QUI    .or. resn %QUINA  .or. resn %DRHM   .or. resn %DFUC   .or. resn %OLI    .or. -
                    resn %TYV    .or. resn %BEQ    .or. resn %PAR    .or. resn %DIG    .or. resn %DARBP  .or. -
                    resn %LYXP   .or. resn %XYL    .or. resn %RIBP   .or. resn %BAC    .or. resn %HEP    .or. -
                    resn %DHEP   .or. resn %6HEP   .or. resn %MU2AC  .or. resn %MU2GC  .or. resn %MUR    ) -
                 .and. type O5 end
define LCARB sele ( resn %LGLC   .or. resn %LGLNA  .or. resn %LMAN   .or. resn %LMANA  .or. resn %LGAL   .or. -
                    resn %LGANA  .or. resn %LGUL   .or. resn %LGUNA  .or. resn %LGULA  .or. resn %LALT   .or. -
                    resn %LATNA  .or. resn %LALTA  .or. resn %LALL   .or. resn %LTAL   .or. resn %LTANA  .or. -
                    resn %LIDO   .or. resn %IDONA  .or. resn %IDOA   .or. resn %LQUI   .or. resn %RHM    .or. -
                    resn %RHMNA  .or. resn %L6ALT  .or. resn %L6TAL  .or. resn %FUC    .or. resn %FUCNA  .or. -
                    resn %COL    .or. resn %ARBP   .or. resn %ASC    .or. resn %LXYL   .or. resn %LRIBP  ) - 
                 .and. type O5 end
define UDCARB sele ( resn %KDN    .or. resn %LEG    .or. resn %8LEG   .or. resn %PSE    .or. resn %NE5AC  .or. -
                     resn %NE5GC  .or. resn %NEU    .or. resn %FRUP   .or. resn %TAGP   .or. resn %SORP   .or. -
                     resn %PSIP   ) -
                 .and. type O6 end
define ULCARB sele ( resn %KDO    .or. resn %KDA    .or. resn %KO     .or. resn %DHA    .or. resn %LTAGP  ) -
                 .and. type O6 end
define CARB sele DCARB .or. LCARB .or. UDCARB .or. ULCARB end

calc cntmax = ?nsel
if cntmax .eq. 0 goto skipcarb

set iatom = 1
set icnt = 1
label DOCARB
  
   define XXX sele CARB .and. bynu @iatom:@natom end
   set segid = ?selsegi
   set resid = ?selresi
   set iatom = ?selatom

!
! Generic D-sugars
!
   define YYY sele DCARB .and. segid @segid .and. resid @resid end
   if ?nsel .eq. 0 goto skip1

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid O5 -
             @segid @resid C1 -
             @segid @resid C2 -
             @segid @resid C3

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C1 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid O5

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid O5 -
             @segid @resid C1

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C5 -
             @segid @resid O5 -
             @segid @resid C1 -
             @segid @resid C2

   label skip1

!
! Generic L-sugars
!
   define YYY sele LCARB .and. segid @segid .and. resid @resid end
   if ?nsel .eq. 0 goto skip2

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid O5 -
             @segid @resid C1 -
             @segid @resid C2 -
             @segid @resid C3

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C1 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid O5

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid O5 -
             @segid @resid C1

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C5 -
             @segid @resid O5 -
             @segid @resid C1 -
             @segid @resid C2

   label skip2

!
! Unusual pyranoses (NEU type ulosonic acids)
!
   define YYY sele UDCARB .and. segid @segid .and. resid @resid end
   if ?nsel .eq. 0 goto skip3

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid O6 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid C6

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid C6 -
             @segid @resid O6

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C5 -
             @segid @resid C6 -
             @segid @resid O6 -
             @segid @resid C2

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C6 -
             @segid @resid O6 -
             @segid @resid C2 -
             @segid @resid C3

   label skip3

!
! Unusual pyranoses (KDO type ulosonic acids)
!
   define YYY sele ULCARB .and. segid @segid .and. resid @resid end
   if ?nsel .eq. 0 goto skip4

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid O6 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C2 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C3 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid C6

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C4 -
             @segid @resid C5 -
             @segid @resid C6 -
             @segid @resid O6

   cons dihe force @cring min  60.0 width 2.5 -
             @segid @resid C5 -
             @segid @resid C6 -
             @segid @resid O6 -
             @segid @resid C2

   cons dihe force @cring min -60.0 width 2.5 -
             @segid @resid C6 -
             @segid @resid O6 -
             @segid @resid C2 -
             @segid @resid C3

   label skip4

incr iatom by 1
incr icnt by 1
if icnt .le. @cntmax goto DOCARB

label skipcarb